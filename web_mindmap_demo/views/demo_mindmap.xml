<?xml version="1.0" encoding="utf-8"?>
<!--
    Copyright (c) 2026 HosamAE
    Licensed under the GNU Lesser General Public License v3.0 or later (LGPL-3.0-or-later)
    See the LICENSE file in the project root for more information.
-->
<odoo>
    <!-- Search View -->
    <record id="view_mindmap_demo_search" model="ir.ui.view">
        <field name="name">mindmap.demo.search</field>
        <field name="model">mindmap.demo</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="state"/>
                <filter string="Active" name="active" domain="[('state', '=', 'active')]"/>
                <filter string="Blocked" name="blocked" domain="[('state', '=', 'blocked')]"/>
            </search>
        </field>
    </record>

    <!-- View Definition -->
    <record id="view_mindmap_demo_mindmap" model="ir.ui.view">
        <field name="name">mindmap.demo.mindmap</field>
        <field name="model">mindmap.demo</field>
        <field name="arch" type="xml">
            <mindmap parent_field="mindmap_parent_id" child_field="mindmap_child_ids" default_depth="3">
                <field name="name"/>
                <field name="mindmap_parent_id"/>
                <field name="progress"/>
                <field name="state"/>
                <field name="icon"/>
                <field name="mindmap_color"/>
                <field name="budget"/>
                <templates>
                    <t t-name="mindmap-box">
                        <div class="o_mindmap_card_content" t-attf-style="border-top: 5px solid {{record.mindmap_color_hex || '#007bff'}};">
                            <div class="d-flex align-items-center mb-2">
                                <i t-attf-class="fa {{record.icon}} fa-lg me-2" t-attf-style="color: {{record.mindmap_color_hex || '#6c757d'}};"></i>
                                <strong class="text-truncate"><field name="name"/></strong>
                            </div>
                            
                            <div class="o_mindmap_metrics small text-muted">
                                <div t-if="record.budget">
                                    <i class="fa fa-money me-1"/> <field name="budget"/>
                                </div>
                            </div>
 
                            <div t-if="record.progress" class="progress mt-2" style="height: 6px;">
                                <div class="progress-bar" t-attf-style="width: {{record.progress}}%; background-color: {{record.mindmap_color_hex}}"></div>
                            </div>
                        </div>
                    </t>
                </templates>
            </mindmap>
        </field>
    </record>

    <!-- Separate View for the MindMap Field -->
    <record id="view_mindmap_demo_field_mindmap" model="ir.ui.view">
        <field name="name">mindmap.demo.field.mindmap</field>
        <field name="model">mindmap.demo</field>
        <field name="arch" type="xml">
            <mindmap parent_field="mindmap_parent_id" child_field="mindmap_child_ids" default_depth="3">
                <field name="name"/>
                <field name="mindmap_parent_id"/>
                <field name="progress"/>
                <field name="state"/>
                <field name="icon"/>
                <field name="mindmap_color"/>
                <templates>
                    <t t-name="mindmap-box">
                        <div class="o_mindmap_card_content" t-attf-style="border-top: 5px solid {{record.mindmap_color_hex || '#007bff'}};">
                            <div class="d-flex align-items-center mb-2">
                                <i t-attf-class="fa {{record.icon}} fa-lg me-2" t-attf-style="color: {{record.mindmap_color_hex || '#6c757d'}};"></i>
                                <strong class="text-truncate"><field name="name"/></strong>
                            </div>
                        </div>
                    </t>
                </templates>
            </mindmap>
        </field>
    </record>

    <record id="view_mindmap_demo_form" model="ir.ui.view">
        <field name="name">mindmap.demo.form</field>
        <field name="model">mindmap.demo</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <field name="state" widget="statusbar" options="{'clickable': '1'}"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1><field name="name"/></h1>
                    </div>
                    <group>
                        <group string="Objective Metrics">
                            <field name="progress" widget="progressbar"/>
                            <field name="budget"/>
                            <field name="icon"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="General Description">
                            <field name="mindmap_description" placeholder="Describe the node objective here..."/>
                        </page>
                        <page string="Sub-tasks MindMap" name="mindmap_field">
                            <field name="mindmap_child_ids" widget="mindmap" mode="mindmap"
                                   context="{'default_mindmap_parent_id': id}"
                                   options="{'parentField': 'mindmap_parent_id', 'childField': 'mindmap_child_ids'}">
                            </field>
                        </page>
                        <page string="Mindmap Inspector" name="mindmap_settings">
                            <group string="Hierarchy &amp; Layout">
                                <group>
                                    <field name="mindmap_parent_id"/>
                                    <field name="mindmap_color" widget="color"/>
                                </group>
                                <group>
                                    <field name="mindmap_template_id"/>
                                </group>
                            </group>
                            <p class="text-muted italic small mt-2">
                                <i class="fa fa-info-circle me-1"/> 
                                Adjust hierarchical links and visual branding for this specific node.
                            </p>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- NEW DEDICATED SETTINGS VIEW (INHERITING FROM BASE) -->
    <record id="view_mindmap_demo_settings_form" model="ir.ui.view">
        <field name="name">mindmap.demo.settings.form</field>
        <field name="model">mindmap.demo</field>
        <field name="inherit_id" ref="web_mindmap_view.view_mindmap_base_settings"/>
        <field name="arch" type="xml">
            <xpath expr="//group" position="after">
                <p class="text-info small mt-2">
                    <i class="fa fa-info-circle"/> This is a custom settings view inheriting from the base Mindmap Config.
                </p>
            </xpath>
        </field>
    </record>

    <!-- Action -->
    <record id="action_mindmap_demo" model="ir.actions.act_window">
        <field name="name">Strategic Usage Map</field>
        <field name="res_model">mindmap.demo</field>
        <field name="view_mode">mindmap,list,form</field>
    </record>

    <!-- Menu -->
    <menuitem id="menu_mindmap_demo_root" name="Strategy Board" sequence="10" web_icon="web_mindmap_demo,static/description/menu_icon.png"/>
    <menuitem id="menu_mindmap_demo_main" parent="menu_mindmap_demo_root" action="action_mindmap_demo" sequence="1"/>

    <!-- Template 1: Strategic Deep Dive (Metrics Focus) -->
    <record id="demo_template_strategic" model="mindmap.template">
        <field name="name">Strategic Deep Dive</field>
        <field name="model_id" search="[('model', '=', 'mindmap.demo')]"/>
        <field name="field_ids" eval="[
            (6, 0, [
                ref('web_mindmap_demo.field_mindmap_demo__budget'),
                ref('web_mindmap_demo.field_mindmap_demo__progress'),
                ref('web_mindmap_demo.field_mindmap_demo__state')
            ])
        ]"/>
    </record>

    <!-- Template 2: Operational Insight (Description Focus) -->
    <record id="demo_template_ops" model="mindmap.template">
        <field name="name">Operational Insight</field>
        <field name="model_id" search="[('model', '=', 'mindmap.demo')]"/>
        <field name="field_ids" eval="[
            (6, 0, [
                ref('web_mindmap_demo.field_mindmap_demo__state'),
                ref('web_mindmap_demo.field_mindmap_demo__mindmap_description')
            ])
        ]"/>
    </record>

    <!-- Rich Demo Data -->
    <data noupdate="0">
        <!-- ROOT NODE -->
        <record id="demo_vision" model="mindmap.demo">
            <field name="name">Global Expansion 2026</field>
            <field name="state">active</field>
            <field name="progress">45</field>
            <field name="mindmap_color">#6f42c1</field>
            <field name="icon">fa-globe</field>
            <field name="budget">5000000</field>
            <field name="mindmap_template_id" ref="demo_template_strategic"/>
            <field name="mindmap_description">Our primary goal is to establish a strong presence in the EMEA and APAC regions by the end of 2026.</field>
        </record>

        <!-- BRANCH 1: TECH (Parent: Vision) -->
        <record id="demo_tech" model="mindmap.demo">
            <field name="name">Tech Infrastructure</field>
            <field name="mindmap_parent_id" ref="demo_vision"/>
            <field name="state">active</field>
            <field name="progress">60</field>
            <field name="mindmap_color">#007bff</field>
            <field name="icon">fa-server</field>
            <field name="budget">1200000</field>
            <field name="mindmap_template_id" ref="demo_template_ops"/>
            <field name="mindmap_description">Modernizing our infrastructure to support high-concurrency global traffic.</field>
        </record>
            <record id="demo_tech_be" model="mindmap.demo">
                <field name="name">Backend Refactor (Python Odoo 18)</field>
                <field name="mindmap_parent_id" ref="demo_tech"/>
                <field name="progress">80</field>
                <field name="mindmap_color">#17a2b8</field>
                <field name="icon">fa-cogs</field>
                <field name="mindmap_template_id" ref="demo_template_ops"/>
                <field name="mindmap_description">Upgrading the core logic to leverage Odoo 18's performance improvements.</field>
            </record>
                <record id="demo_deep_1" model="mindmap.demo">
                    <field name="name">Optimization Layer</field>
                    <field name="mindmap_parent_id" ref="demo_tech_be"/>
                    <field name="mindmap_color">#6610f2</field>
                    <field name="mindmap_template_id" ref="demo_template_ops"/>
                </record>
            <record id="demo_tech_fe" model="mindmap.demo">
                <field name="name">Frontend Revamp (OWL)</field>
                <field name="mindmap_parent_id" ref="demo_tech"/>
                <field name="progress">30</field>
                <field name="mindmap_color">#fd7e14</field>
                <field name="icon">fa-desktop</field>
                <field name="mindmap_template_id" ref="demo_template_ops"/>
            </record>

        <!-- BRANCH 2: OPERATIONS (Parent: Vision) -->
        <record id="demo_ops" model="mindmap.demo">
            <field name="name">Global Operations</field>
            <field name="mindmap_parent_id" ref="demo_vision"/>
            <field name="state">active</field>
            <field name="progress">35</field>
            <field name="mindmap_color">#28a745</field>
            <field name="icon">fa-briefcase</field>
            <field name="budget">2000000</field>
            <field name="mindmap_template_id" ref="demo_template_strategic"/>
        </record>
            <record id="demo_ops_logistics" model="mindmap.demo">
                <field name="name">Supply Chain Automation</field>
                <field name="mindmap_parent_id" ref="demo_ops"/>
                <field name="progress">40</field>
                <field name="mindmap_color">#20c997</field>
                <field name="icon">fa-truck</field>
                <field name="mindmap_template_id" ref="demo_template_ops"/>
            </record>

        <!-- BRANCH 3: CUSTOMER SUCCESS (Parent: Vision) -->
        <record id="demo_cs" model="mindmap.demo">
            <field name="name">Customer Experience</field>
            <field name="mindmap_parent_id" ref="demo_vision"/>
            <field name="progress">55</field>
            <field name="mindmap_color">#e83e8c</field>
            <field name="icon">fa-heart</field>
            <field name="mindmap_template_id" ref="demo_template_strategic"/>
        </record>
            <record id="demo_cs_support" model="mindmap.demo">
                <field name="name">24/7 Global Support</field>
                <field name="mindmap_parent_id" ref="demo_cs"/>
                <field name="mindmap_color">#ae63e4</field>
                <field name="icon">fa-headset</field>
                <field name="mindmap_template_id" ref="demo_template_ops"/>
            </record>

        <!-- BRANCH 4: INNOVATION (Parent: Vision) -->
        <record id="demo_product" model="mindmap.demo">
            <field name="name">Product Innovation</field>
            <field name="mindmap_parent_id" ref="demo_vision"/>
            <field name="progress">50</field>
            <field name="mindmap_color">#20c997</field>
            <field name="icon">fa-lightbulb-o</field>
            <field name="mindmap_template_id" ref="demo_template_strategic"/>
        </record>
            <record id="demo_product_ai" model="mindmap.demo">
                <field name="name">Agentic AI Workflows</field>
                <field name="mindmap_parent_id" ref="demo_product"/>
                <field name="mindmap_color">#6610f2</field>
                <field name="icon">fa-magic</field>
                <field name="mindmap_template_id" ref="demo_template_ops"/>
            </record>

        <!-- BRANCH 5: HR (Parent: Vision) -->
        <record id="demo_hr" model="mindmap.demo">
            <field name="name">Talent Acquisition</field>
            <field name="mindmap_parent_id" ref="demo_vision"/>
            <field name="state">blocked</field>
            <field name="progress">10</field>
            <field name="mindmap_color">#dc3545</field>
            <field name="icon">fa-users</field>
            <field name="mindmap_template_id" ref="demo_template_strategic"/>
        </record>
    </data>
</odoo>
